$(function(){$("#mobileMenuToggle").on("click",function(e){$("header nav").toggle()});$(document).on("submit","#summonerForm",function(e){var t=$(this);var n=t.parent();n.toggleLoadingImage();t.ajaxSubmit({target:"#summonerForm",success:function(e){if(e.redirect){window.location.href=t.attr("action")}n.toggleLoadingImage()},type:"post"});return false});$(".summonerMeta").on("click",function(e){if(confirm("Do you really want to remove the summoner from your account?")){var t=$(this).closest("li");$.ajax({url:baseUrl+"/account/remove-summoner",type:"POST",data:{summonerId:t.attr("class").substr(9)}}).success(function(e){if(e.success==1){var n=t.parent();if(n.children().length==1){n.replaceWith($("<div/>",{"class":"empty",text:"You haven't added a League of Legends account yet! Add one using the button on the right."}))}t.detach()}addMessage(e.message)}).error(function(e,t){addMessage("Something with wrong, please try again.")})}});$("#addSummonerToggle").on("click",function(t){var n=$("#addSummoner");var r=n.clone();n.addClass("hideAfter").show().focusLight();e=n});$("#announcement .remove").on("click",function(e){var t=$(this).parent();var n=t.attr("data-scope");t.detach();createCookie(n,"true",5)});$(".moduleSort select").on("change",function(e){var t=$(this);var n=t.val();window.location.href=n});if($("#main .module").attr("id")=="random"){$.ajax({url:baseUrl+"/feed/get-random-feed"}).success(function(e){console.log(e);window.location.href=baseUrl+"/feed/"+e.feedId}).error(function(e,t){console.log(status);window.location.href=baseUrl+"/random"})}$(document).on("click",".openInWindow",function(e){var t=$(this).attr("href");var n="popUp";var r="width=650,height=400,scrollbars=yes";window.open(t,n,r);event.preventDefault()});var e="";var t=$("#flash");if(t.is(":visible")){t.setRemoveTimeout(5e3)}$(".verticalFeedList").each(function(e){$(this).perfectScrollbar({wheelSpeed:50})});$("#commentList").perfectScrollbar({wheelSpeed:50});$("#youtubers").perfectScrollbar({wheelSpeed:50,suppressScrollY:true});$("#addComment").on("keyup",function(e){var t=$(this);var n=t.val();var r=t.parent().find("#remainingChars .number");if(n.length>150){r.addClass("redFont")}else{r.removeClass("redFont");r.html(150-n.length)}});$("#addComment").pressEnter(function(){var e=$(this);var t=e.val();if(t.length<=150){var n=$("#feed").attr("class").substr(5);$.ajax({url:baseUrl+"/comment/add",type:"POST",data:{feedId:n,content:t},dataType:"html"}).success(function(t){if(!isEmpty(t)){var n=$(".emptyComments");if(n.length!=0){n.replaceWith($("<ul/>",{id:"commentList",html:t}).perfectScrollbar({wheelSpeed:50}))}else{$("#commentList").append(t).perfectScrollbar("update")}e.val("");e.parent().find("#remainingChars .number").html(150)}})}else{return}});var n=false;$(".module ul.expandable").on("scroll",function(e){var t=$(this);if(t.scrollTop()===t.prop("scrollHeight")-t.height()){if(!n){var r=t.attr("id");var i=parseInt(t.attr("data-page"))+1;var s=t.attr("data-total");if(i-1>=s){var o=t.children(".limit-reached");if(o.length!=0){return}else{o=$("<li />",{"class":"limit-reached",text:"There are no more feeds available."}).appendTo(t)}}else{n=true;t.toggleLoadingImage();$.ajax({url:baseUrl+"/get-more-feeds/"+r+"/"+i,dataType:"html"}).success(function(e){n=false;t.append(e).perfectScrollbar("update").toggleLoadingImage()});t.attr("data-page",i)}}}});$("#youtubersFeeds").on("scroll",function(e){var t=$(this);if(t.scrollTop()===t.prop("scrollHeight")-t.height()){if(!n){n=true;var r=t.attr("data-token");if(r!="finished"){var i=$("#youtubers li.active span").attr("class").substr(9);t.toggleLoadingImage();$.ajax({url:baseUrl+"/feed/get-youtuber-feeds/"+i+"/false/"+r,timeout:2e4}).success(function(e){var s=e.nextToken==null?"finished":e.nextToken;t.attr("data-token",s);$.ajax({url:baseUrl+"/feed/get-youtuber-feeds/"+i+"/return/"+r,timeout:2e4}).success(function(e){t.append(e);t.toggleLoadingImage();n=false;t.perfectScrollbar("destroy");t.perfectScrollbar({wheelSpeed:50})}).error(function(e,t){console.log(status)})}).error(function(e,t){console.log(status)})}}}});var r=false;$("#youtubers li").on("click",function(e){var t=$(this);delay(function(){if(t.hasClass("active")||r)return;r=true;t.addClass("active");t.siblings(".active").removeClass("active");var e=$("#youtubersFeeds");var n=e.parent();var i=t.find('span[class^="youtuber"]');var s=i.attr("class").substring(9);e.slideUp();n.toggleLoadingImage();$.ajax({url:baseUrl+"/feed/get-youtuber-feeds/"+s,timeout:2e4}).success(function(t){var o=t.nextToken==null?"finished":t.nextToken;e.attr("data-token",o);$.ajax({url:baseUrl+"/feed/get-youtuber-feeds/"+s+"/return",timeout:2e4}).success(function(t){e.find("li").detach();e.prepend(t).slideDown();e.parent().siblings("h1").html(i.html()+"'s Latest Feeds");n.toggleLoadingImage();r=false;e.perfectScrollbar("update")}).error(function(e,t){console.log(status)})}).error(function(e,t){console.log(status)})},150)});$(".hideToggle").on("click",function(e){var t=$(this);var n=t.siblings(".moduleBody");if(n.is(":visible")){n.slideUp();t.html("Show")}else{n.slideDown();t.html("Hide")}});$(document).on("click",function(t){if(t.target.id=="shadow"){e.unfocusLight();$("body").removeClass("unscrollable");if(e.attr("id")=="stage"){e.find("iframe").detach();e.hide()}else if(e.hasClass("hideAfter")){e.hide()}else{e.detach()}}});$(document).on("click","#rating a",function(e){var t=$(this);if(t.attr("href")=="#"){e.preventDefault()}else{return}var n=t.siblings('a[id^="thumb"]');if(!t.hasClass("disabled")){t.addClass("disabled");var r=t.attr("id");var i=$("#feed");var s=i.attr("class").substring(5);$.ajax({url:baseUrl+"/feed/rate/"+r+"/id/"+s,timeout:5e3}).success(function(e){if(e.success==1){var t=$("#total .count");var i=parseInt(t.html());if(n.hasClass("disabled")){n.removeClass("disabled");i+=r=="thumbUp"?2:-2}else{i+=r=="thumbUp"?1:-1}t.html(i)}else{addMessage(e.message)}})}});$(document).on("click",".verticalFeedList li .videoMask",function(t){if(!isMobile){t.preventDefault();t.stopPropagation();var n=$(this).parent();var r=n.closest("li");var i=r.attr("data-video-id");var s=r.attr("class").substr(5);toggleVideo("hide");var o=$("<div/>",{id:"stageWrapper"}).prependTo($("body"));var u=$("<div/>",{id:"stage"}).appendTo(o);var a=$("<div/>",{id:"videoWrapper"}).appendTo(u);var f=$("<iframe/>",{id:"youtubeVideo",frameborder:0,src:"http://www.youtube.com/embed/"+i+"?autoplay=1"}).appendTo(a);e=o;o.addClass("target-"+i).focusLight();$("body").addClass("unscrollable");$.ajax({url:baseUrl+"/feed/add-to-watched/"+s,timeout:5e3}).success(function(e){if(e.success!=1){console.log(e.message)}})}})})